function update_head(){$("#upload_image").trigger("click")}function upload_head(a){var t=a.files[0].size;if(t>1024e4){toastr.error("图片大小不能超过10MB");return}var s=new FormData;s.append("head",a.files[0]);s.append("u_id",u_id);$.ajax({url:"php/uploads_head.php",type:"POST",data:s,cache:false,contentType:false,processData:false,dataType:"json",success:function(a){if(a.status==0){$("#head_picture").attr("src",a.url);toastr.success("更新成功")}else{toastr.warning(a.error)}},error:function(a){toastr.error("HTTP状态码："+a.status)}})}$("#btn_update_nick").click(function(){var a=$(this).attr("value");var t=$("#username_label");var s=$("#input_new_nick");if(a==0){t.addClass("hide");s.removeClass("hide");s.val(t.html());$(this).attr("value",1);$(this).html("保存")}else{var r=$.trim(s.val());if(r==""||/^\s+$/.test(r)){s.val("");s.focus();toastr.warning("请输入有效的用户名");return}if(r==username_ws){t.removeClass("hide");s.addClass("hide");t.html(r);$(this).attr("value",0);$(this).html("修改");return}$.ajax({url:"php/ajax.php",type:"POST",data:{func:"update_username",new_nick:r},dataType:"json",success:function(a){if(a.status==0){t.removeClass("hide");s.addClass("hide");t.html(r);$("#btn_update_nick").attr("value",0);$("#btn_update_nick").html("修改");$("#username").html(r);toastr.success("更新成功");username_ws=r}else if(a.status==-3){s.focus();toastr.warning(a.error)}else{toastr.warning(a.error)}},error:function(a){toastr.error("HTTP状态码："+a.status)}})}});$("#btn_update_sex").click(function(){var a=$(this).attr("value");var t=$("#sex");if(a==0){t.attr("disabled",false);$(this).attr("value",1);$(this).html("保存")}else{var s=t.val();if(s!="0"&&s!="1"&&s!="2"){toastr.warning("发生未知错误，建议刷新页面，或联系管理员");return}if(s==sex){t.attr("disabled",true);$(this).attr("value",0);$(this).html("修改");return}$.ajax({url:"php/ajax.php",type:"POST",data:{func:"update_sex",new_sex:s},dataType:"json",success:function(a){if(a.status==0){t.attr("disabled",true);$("#btn_update_sex").attr("value",0);$("#btn_update_sex").html("修改");toastr.success("更新成功");sex=s}else{toastr.warning(a.error)}},error:function(a){toastr.error("HTTP状态码："+a.status)}})}});$("#update_password").click(function(){var a=$("#oldPassword").val();var t=$("#newPassword").val();var s=$("#confirmPassword").val();if(t.length<6||t.length>20){$("#oldPassword").focus();toastr.warning("密码长度须为6至20位");return}if(t!=s){$("#confirmPassword").focus();toastr.warning("密码不一致，请认真校对");return}if(t==a){$("#newPassword").focus();toastr.warning("原密码与新密码一致，请认真校对");return}a=a.MD5(32);t=t.MD5(32);$.ajax({url:"php/ajax.php",type:"POST",data:{func:"update_password",oldPassword:a,newPassword:t},dataType:"json",success:function(a){$("#register").attr("disabled",false);if(a.status==0){$("#oldPassword").val("");$("#newPassword").val("");$("#confirmPassword").val("");toastr.success("密码修改成功")}else if(a.status==-3){$("#oldPassword").focus();toastr.warning(a.error)}else{toastr.warning(a.error)}},error:function(a){$("#register").attr("disabled",false);toastr.error("HTTP状态码："+a.status)}})});