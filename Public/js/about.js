var hashArray=["#info","#skill","#hobbies","#about","#send_to_me"];var is_first=true;$(".click_to_active").click(function(){$(".click_to_active").removeClass("active");$(this).addClass("active")});var index=$.inArray(window.location.hash,hashArray);if(index!=-1){document.getElementsByClassName("click_to_active")[index].click()}function send_message(){if($("#switch_editor").attr("value")==0){var e=document.getElementsByClassName("editormd-preview-container")[0].innerHTML;document.getElementsByClassName("editormd-preview-container")[0].innerHTML="";testEditor.setMarkdown("")}else{var e=$("#textarea_editor").summernote("code");$("#textarea_editor").summernote("code","")}if(e==""||/^\s+$/.test(e)){toastr.warning("您没有写任何有效的消息内容");return}var t={status:1,string:"发送消息",content:e,u_id:u_id,send_to_me:true,from_username:username_ws};t=JSON.stringify(t);ws_send(t)}function do_other_thing_islogin(){$("#layout").append($('<div class="editormd hide" id="test-editormd"><textarea></textarea></div>'));$("#layout").append($('<div id="textarea_editor"></div>'));$("#layout").append($('<button type="button" class="btn btn-lg btn-primary pull-right" onclick="send_message()">Send</button>'));$("#layout").append($('<button id="switch_editor" type="button" value=1 class="btn btn-primary" onclick="switch_editor(this)">USE MD</button>'));$("#cant_send_to_me").html("");$("#textarea_editor").summernote({height:300,minHeight:null,maxHeight:null,focus:true,callbacks:{onImageUpload:function(e){var t=e[0].size;if(t>1024e4){toastr.error("图片大小不能超过10MB");return}var i=this;var a=new FormData;a.append("editormd-image-file",e[0]);$.ajax({url:"editor.md/examples/php/upload.php",type:"POST",data:a,dataType:"json",cache:false,contentType:false,processData:false,success:function(e){if(e.success==1){$("#"+i.id).summernote("insertImage",e.url)}else{toastr.warning(e.message)}},error:function(e){toastr.error("HTTP状态码："+e.status)}})}}});$(".note-image-input").attr("multiple",null);if(!isMobile()){$("#switch_editor").trigger("click")}}function do_other_thing_logout(){$("#layout").html("");$("#cant_send_to_me").html('请先<a href="./'+loginString+'">登录</a>')}function switch_editor(e){e=$(e);var t=e.parent(":first");if(e.attr("value")==0){t.children().eq(0).addClass("hide");t.children().eq(2).removeClass("hide");t.children().eq(1).summernote("focus");e.attr("value",1);e.html("USE MD")}else{if(is_first){testEditor=editormd("test-editormd",{width:"100%",height:500,path:"editor.md/lib/",theme:"default",previewTheme:"default",editorTheme:"base16-light",codeFold:true,saveHTMLToTextarea:true,searchReplace:true,htmlDecode:"style,script,iframe|on*",emoji:true,taskList:true,tocm:true,tex:true,flowChart:true,sequenceDiagram:true,imageUpload:true,imageFormats:["jpg","jpeg","pjpeg","ico","gif","png","bmp","webp"],imageUploadURL:"editor.md/examples/php/upload.php",onload:function(){console.log("onload",this)}});is_first=false}t.children().eq(0).removeClass("hide");t.children().eq(2).addClass("hide");e.attr("value",0);e.html("USE TEXTAREA")}}